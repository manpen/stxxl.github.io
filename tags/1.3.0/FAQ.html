<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Stxxl: FAQ - Frequently Asked Questions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>FAQ - Frequently Asked Questions </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="FAQ-latest"></a>
Latest version of this FAQ</h2>
<p>The most recent version of this FAQ can always be found <a href="http://algo2.iti.kit.edu/stxxl/trunk/FAQ.html">here</a>.</p>
<h2><a class="anchor" id="q1"></a>
References to Elements in External Memory Data Structures</h2>
<p>You should not pass or store references to elements in an external memory data structure. When the reference is used, the block that contains the element may be no longer in internal memory.<br/>
 Use/pass an iterator (reference) instead.<br/>
 For an <code>stxxl::vector</code> with <code>n</code> pages and LRU replacement strategy, it can be guaranteed that the last <code>n</code> references obtained using <code>stxxl::vector::operator</code>[] or dereferencing an iterator are valid. However, if <code>n</code> is 1, even a single innocent-looking line like </p>
<div class="fragment"><pre class="fragment">std::cout &lt;&lt; v[0] &lt;&lt; " " &lt;&lt; v[1000000] &lt;&lt; std::endl; </pre></div><p> can lead to inconsistent results. <br/>
</p>
<h2><a class="anchor" id="q2"></a>
Parameterizing STXXL Containers</h2>
<p>STXXL container types like stxxl::vector can be parameterized only with a value type that is a <a href="http://en.wikipedia.org/wiki/Plain_old_data_structures">POD</a> (i. e. no virtual functions, no user-defined copy assignment/destructor, etc.) and does not contain references (including pointers) to internal memory. Usually, "complex" data types do not satisfy this requirements.</p>
<p>This is why stxxl::vector&lt;std::vector&lt;T&gt; &gt; and stxxl::vector&lt;stxxl::vector&lt;T&gt; &gt; are invalid. If appropriate, use std::vector&lt;stxxl::vector&lt;T&gt; &gt;, or emulate a two-dimensional array by doing index calculation.</p>
<h2><a class="anchor" id="q3"></a>
Thread-Safety</h2>
<p>The I/O and block management layers are thread-safe (since release 1.1.1). The user layer data structures are not thread-safe.<br/>
 I.e. you may access <b>different</b> <code>S<small>TXXL</small></code> data structures from concurrent threads without problems, but you should not share a data structure between threads (without implementing proper locking yourself).<br/>
 This is a design choice, having the data structures thread-safe would mean a significant performance loss.</p>
<h2><a class="anchor" id="q4"></a>
I have configured several disks to use with STXXL. Why does STXXL fail complaining about the lack of space? According to my calclulations, the space on the disks should be sufficient.</h2>
<p>This may happen if the disks have different size. With the default parameters <code>S<small>TXXL</small></code> containers use randomized block-to-disk allocation strategies that distribute data evenly between the disks but ignore the availability of free space on them.</p>
<h2><a class="anchor" id="q5"></a>
STXXL in a Microsoft CLR Library</h2>
<p>From STXXL user Christian, posted in the <a href="https://sourceforge.net/projects/stxxl/forums/forum/446474/topic/3407329">forum</a>:</p>
<p>Precondition: I use STXXL in a Microsoft CLR Library (a special DLL). That means that managed code and native code (e.g. STXXL) have to co-exist in your library.</p>
<p>Symptom: Application crashes at process exit, when the DLL is unloaded.</p>
<p>Cause: STXXL's singleton classes use the <code>atexit()</code> function to destruct themselves at process exit. The exit handling will cause the process to crash at exit (still unclear if it's a bug or a feature of the MS runtime).</p>
<p>Solution:</p>
<p>1.) Compiled STXXL static library with <code>STXXL_NON_DEFAULT_EXIT_HANDLER</code> defined.</p>
<p>2.) For cleanup, <code>stxxl::run_exit_handlers()</code> has now to be called manually. To get this done automatically:</p>
<p>Defined a CLI singleton class "Controller":</p>
<div class="fragment"><pre class="fragment">
public ref class Controller {
private: 
    static Controller^ instance = gcnew Controller;
    Controller();
};
</pre></div><p>Registered my own cleanup function in Controller's constructor which will manage to call <code>stxxl::run_exit_handlers()</code>:</p>
<div class="fragment"><pre class="fragment">
#pragma managed(push, off)
static int myexitfn()
{
    stxxl::run_exit_handlers();
    return 0;
}
#pragma managed(pop)

Controller::Controller()
{
    onexit(myexitfn);
}
</pre></div><h2><a class="anchor" id="q6"></a>
How can I credit STXXL, and thus foster its development?</h2>
<ul>
<li>For all users: Sign up at Ohloh and add yourself as an STXXL user / rate STXXL: <a href="http://www.ohloh.net/p/stxxl">http://www.ohloh.net/p/stxxl</a></li>
</ul>
<ul>
<li>For scientific work: Cite the papers mentioned here: <a href="http://stxxl.sourceforge.net/">http://stxxl.sourceforge.net/</a></li>
</ul>
<ul>
<li>For industrial users: Tell us the name of your company, so we can use it as a reference. </li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
